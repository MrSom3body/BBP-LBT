- name: Set common configuration
  hosts:
    - hq-router
    - sub-router
  roles:
    - common

- name: Configure HQ Router
  hosts:
    - hq-router
  roles:
    - lin_router
  become: true
  tasks:
    - name: Configure WAN (ens33) as a DHCP Client
      community.general.nmcli:
        conn_name: WAN
        ifname: ens33
        type: ethernet
        method4: manual
        ip4: 10.187.0.10/24
        gw4: 10.187.0.2
        zone: external
        autoconnect: yes
        state: present
    - name: Configure Core LAN
      community.general.nmcli:
        conn_name: Core LAN
        ifname: ens37
        type: ethernet
        method4: manual
        ip4: 10.10.10.254/24
        never_default4: yes
        zone: trusted
        autoconnect: yes
        state: present
    - name: Configure Management LAN
      community.general.nmcli:
        conn_name: Management LAN
        ifname: ens38
        type: ethernet
        method4: manual
        ip4: 10.10.50.254/24
        never_default4: yes
        zone: trusted
        autoconnect: yes
        state: present
    - name: Configure Client LAN
      community.general.nmcli:
        conn_name: Client LAN
        ifname: ens39
        type: ethernet
        method4: manual
        ip4: 10.10.100.254/24
        never_default4: yes
        zone: trusted
        autoconnect: yes
        state: present

- name: Configure Suboffice Router
  hosts:
    - sub-router
  roles:
    - lin_router
  become: true
  tasks:
    - name: Configure WAN (ens33) as a DHCP Client
      community.general.nmcli:
        conn_name: WAN
        ifname: ens33
        type: ethernet
        method4: manual
        ip4: 10.187.0.20/24
        gw4: 10.187.0.2
        zone: external
        autoconnect: yes
        state: present
    - name: Configure LAN
      community.general.nmcli:
        conn_name: LAN
        ifname: ens37
        type: ethernet
        method4: manual
        ip4: 10.20.20.254/24
        never_default4: yes
        zone: trusted
        autoconnect: yes
        state: present
